{"ast":null,"code":"var _jsxFileName = \"E:\\\\VS_Code\\\\Full-Stack\\\\my_contacts\\\\client\\\\src\\\\context\\\\auth\\\\AuthState.js\",\n    _s = $RefreshSig$();\n\nimport React, { useReducer } from 'react';\nimport axios from 'axios';\nimport AuthContext from './authContext';\nimport authReducer from './authReducer';\nimport setAuthtoken from '../../utils/setAuthtoken';\nimport { REGISTER_SUCCESS, REGISTER_FAIL, LOGIN_SUCCESS, LOGIN_FAIL, USER_LOADED, LOGOUT, AUTH_ERROR, CLEAR_ERROR } from '../types';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst AuthState = props => {\n  _s();\n\n  const initialState = {\n    token: localStorage.getItem('token'),\n    isAuthenticated: null,\n    user: null,\n    error: null,\n    loading: true\n  };\n  const [state, dispatch] = useReducer(authReducer, initialState); //LOAD USER\n\n  const loadUser = async () => {\n    //load token\n    if (localStorage.token) {\n      setAuthtoken(localStorage.token);\n    }\n\n    try {\n      const res = await axios.get('/api/auth');\n      dispatch({\n        type: USER_LOADED,\n        payload: res.data\n      });\n    } catch (error) {\n      dispatch({\n        type: AUTH_ERROR\n      });\n    }\n  }; //REGISTER USER\n\n\n  const register = async formData => {\n    const config = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    };\n\n    try {\n      const res = await axios.post('/api/users', formData, config); //Dispatch & get Token from backend\n\n      dispatch({\n        type: REGISTER_SUCCESS,\n        payload: res.data\n      });\n      loadUser();\n    } catch (error) {\n      dispatch({\n        type: REGISTER_FAIL,\n        payload: error.response.data.msg\n      });\n    }\n  }; //LOGIN USER\n\n\n  const login = async formData => {\n    const config = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    };\n\n    try {\n      const res = await axios.post('./api/auth', formData, config);\n      dispatch({\n        type: LOGIN_SUCCESS,\n        payload: res.data\n      });\n      loadUser();\n    } catch (error) {\n      dispatch({\n        type: LOGIN_FAIL,\n        payload: error.response.data.msg\n      });\n    }\n  }; //LOGOUT\n\n\n  const logout = () => {\n    clearContacts();\n    dispatch({\n      type: LOGOUT\n    });\n  }; //CLEAR CONTACTS\n  //CLEAR ERRORS\n\n\n  const clearError = () => {\n    dispatch({\n      type: CLEAR_ERROR\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      token: state.token,\n      isAuthenticated: state.isAuthenticated,\n      user: state.user,\n      loading: state.loading,\n      error: state.error,\n      loadUser,\n      register,\n      login,\n      logout,\n      clearError\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 124,\n    columnNumber: 9\n  }, this);\n};\n\n_s(AuthState, \"6JWkGZ32UPfojeNx+xqn8ZU8A0Q=\");\n\n_c = AuthState;\nexport default AuthState;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthState\");","map":{"version":3,"sources":["E:/VS_Code/Full-Stack/my_contacts/client/src/context/auth/AuthState.js"],"names":["React","useReducer","axios","AuthContext","authReducer","setAuthtoken","REGISTER_SUCCESS","REGISTER_FAIL","LOGIN_SUCCESS","LOGIN_FAIL","USER_LOADED","LOGOUT","AUTH_ERROR","CLEAR_ERROR","AuthState","props","initialState","token","localStorage","getItem","isAuthenticated","user","error","loading","state","dispatch","loadUser","res","get","type","payload","data","register","formData","config","headers","post","response","msg","login","logout","clearContacts","clearError","children"],"mappings":"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","sourcesContent":["import React, {useReducer} from 'react';\r\nimport axios from 'axios';\r\nimport AuthContext from './authContext';\r\nimport authReducer from './authReducer';\r\nimport setAuthtoken from '../../utils/setAuthtoken'\r\nimport {\r\n    REGISTER_SUCCESS,\r\n    REGISTER_FAIL ,\r\n    LOGIN_SUCCESS ,\r\n    LOGIN_FAIL ,\r\n    USER_LOADED ,\r\n    LOGOUT ,\r\n    AUTH_ERROR ,\r\n    CLEAR_ERROR \r\n} from '../types';\r\n\r\nconst AuthState = (props) =>{\r\n    const initialState = {\r\n       token : localStorage.getItem('token'),\r\n       isAuthenticated : null,\r\n       user : null,\r\n       error :  null,\r\n       loading : true\r\n    };\r\n\r\n\r\n    const [state, dispatch] = useReducer(authReducer, initialState);\r\n\r\n\r\n    //LOAD USER\r\n    const loadUser = async () => {\r\n        //load token\r\n        if(localStorage.token){\r\n            setAuthtoken(localStorage.token);\r\n        }\r\n\r\n        try {\r\n            const res = await axios.get('/api/auth');\r\n\r\n            dispatch({\r\n                type: USER_LOADED,\r\n                payload: res.data\r\n            })\r\n\r\n        } catch (error) {\r\n            dispatch({\r\n                type: AUTH_ERROR\r\n            })\r\n        }\r\n    }\r\n\r\n\r\n    //REGISTER USER\r\n    const register = async (formData) => {\r\n        const config = {\r\n            headers: {\r\n                'Content-Type' : 'application/json'\r\n            }\r\n        }\r\n\r\n        try {\r\n            const res = await axios.post('/api/users', formData, config);\r\n\r\n            //Dispatch & get Token from backend\r\n            dispatch({\r\n                type: REGISTER_SUCCESS, \r\n                payload: res.data\r\n            })\r\n\r\n            loadUser();\r\n        } catch (error) {\r\n            dispatch({\r\n                type: REGISTER_FAIL, \r\n                payload: error.response.data.msg\r\n            })\r\n        }\r\n    }\r\n\r\n\r\n    //LOGIN USER\r\n    const login = async (formData) => {\r\n        const config = {\r\n            headers: {\r\n                'Content-Type' : 'application/json'\r\n            }\r\n        }\r\n\r\n        try {\r\n            const res = await axios.post('./api/auth', formData, config);\r\n\r\n            dispatch({\r\n                type: LOGIN_SUCCESS,\r\n                payload: res.data\r\n            })\r\n\r\n            loadUser();\r\n        } catch (error) {\r\n            dispatch({\r\n                type: LOGIN_FAIL, \r\n                payload: error.response.data.msg\r\n            })\r\n        }\r\n    }\r\n\r\n\r\n    //LOGOUT\r\n    const logout = () => {\r\n        clearContacts();\r\n        dispatch({\r\n            type: LOGOUT\r\n        })\r\n    }\r\n    \r\n\r\n    //CLEAR CONTACTS\r\n\r\n\r\n    //CLEAR ERRORS\r\n    const clearError = () => {\r\n        dispatch({type: CLEAR_ERROR});\r\n    }\r\n\r\n    return (\r\n        <AuthContext.Provider\r\n        value={{\r\n            token : state.token,\r\n            isAuthenticated : state.isAuthenticated,\r\n            user : state.user,\r\n            loading : state.loading,\r\n            error :  state.error,\r\n            loadUser, register, login, logout, clearError\r\n        }}>\r\n            {props.children}\r\n        </AuthContext.Provider>\r\n    )\r\n};\r\n\r\nexport default AuthState;"]},"metadata":{},"sourceType":"module"}